<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Guia Elétrico Interativo — 4 Circuitos (Open Protásio)</title>
  <style>
    :root{
      --bg:#f7f7fb; --card:#ffffff; --ink:#0f172a; --muted:#64748b; --accent:#2563eb; --ok:#16a34a; --warn:#d97706; --danger:#dc2626; --line:#e5e7eb;
    }
    *{box-sizing:border-box}
    html,body{margin:0;height:100%;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Helvetica,Arial,sans-serif;color:var(--ink);background:var(--bg)}
    .container{max-width:1100px;margin:0 auto;padding:16px}
    header{position:sticky;top:0;background:rgba(255,255,255,.8);backdrop-filter:blur(8px);border-bottom:1px solid var(--line);z-index:10}
    header .row{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:10px 16px}
    h1{font-size:18px;margin:0}
    .sub{font-size:12px;color:var(--muted)}
    .btn{appearance:none;border:1px solid var(--line);background:#fff;color:var(--ink);padding:8px 12px;border-radius:10px;font-size:14px;cursor:pointer;display:inline-flex;align-items:center;gap:8px}
    .btn.primary{background:var(--accent);border-color:var(--accent);color:#fff}
    .btn:active{transform:translateY(1px)}
    .tabs{display:flex;gap:6px;padding:0 16px 12px}
    .tab{padding:8px 12px;border-radius:999px;border:1px solid var(--line);background:#fff;font-size:13px;cursor:pointer}
    .tab.active{background:var(--accent);border-color:var(--accent);color:#fff}
    main{padding:20px 16px}

    .grid{display:grid;gap:16px}
    .grid.cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}
    .grid.cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}
    @media (max-width:900px){.grid.cols-2,.grid.cols-3{grid-template-columns:1fr}}

    .card{background:var(--card);border:1px solid var(--line);border-radius:16px;box-shadow:0 1px 0 rgba(0,0,0,.02)}
    .card .body{padding:16px}
    .title{font-weight:700;font-size:16px;margin:0 0 8px 0;display:flex;align-items:center;gap:8px}
    .kv{display:flex;justify-content:space-between;gap:16px;font-size:14px;border-top:1px dashed var(--line);padding-top:8px;margin-top:8px}
    .muted{color:var(--muted)}
    .sep{height:1px;background:var(--line);margin:8px 0}

    /* table */
    table{width:100%;border-collapse:collapse;font-size:14px}
    thead{background:#f8fafc}
    th,td{padding:10px;border-top:1px solid var(--line);vertical-align:top}
    th:first-child,td:first-child{position:sticky;left:0;background:var(--card)}
    .scroll-x{overflow:auto;border:1px solid var(--line);border-radius:14px;background:#fff}

    /* switches & sliders */
    .row{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .switch{width:42px;height:24px;border-radius:999px;background:#e5e7eb;position:relative;cursor:pointer;flex-shrink:0}
    .switch::after{content:"";position:absolute;top:3px;left:3px;width:18px;height:18px;border-radius:999px;background:#fff;transition:all .2s}
    .switch.on{background:var(--accent)}
    .switch.on::after{left:21px}
    input[type=range]{width:100%}
    input[type=number]{width:100%;padding:8px;border-radius:10px;border:1px solid var(--line)}

    /* bars */
    .bars{display:flex;align-items:flex-end;gap:16px;height:220px}
    .bar{flex:1;background:linear-gradient(180deg, rgba(37,99,235,.9), rgba(37,99,235,.3));border:1px solid rgba(37,99,235,.5);border-radius:10px;display:flex;align-items:flex-end;justify-content:center;transition:height .2s}
    .bar span{font-size:12px;background:#fff;border:1px solid var(--line);border-radius:8px;padding:2px 6px;transform:translateY(6px)}
    .bar-labels{display:flex;gap:16px;margin-top:6px}
    .bar-labels>div{flex:1;text-align:center;font-size:12px;color:var(--muted)}

    .pill{display:inline-block;padding:2px 8px;border-radius:999px;background:#eef2ff;color:#3730a3;font-size:12px}

    .callout{border-radius:12px;padding:10px;font-size:13px}
    .ok{background:#ecfdf5;border:1px solid #bbf7d0;color:#14532d}
    .warn{background:#fffbeb;border:1px solid #fde68a;color:#92400e}
    .danger{background:#fef2f2;border:1px solid #fecaca;color:#991b1b}

    footer{padding:40px 0 60px 0;color:var(--muted);font-size:12px;text-align:center}
    .badge{display:inline-block;padding:2px 6px;border-radius:6px;border:1px solid var(--line);background:#fff;font-size:12px}
  </style>
</head>
<body>
  <header>
    <div class="row container">
      <div>
        <h1>Open Protásio — Instalação elétrica (4 circuitos)</h1>
        <div class="sub">Sem gambiarras. 220 V apenas ACs e chuveiro. Todos os 4 circuitos passam pelo DR.</div>
      </div>
      <div>
        <button class="btn" id="copyBtn">📋 Copiar lista</button>
        <button class="btn primary" id="printBtn">🖨️ Imprimir / PDF</button>
      </div>
    </div>
    <div class="tabs container">
      <button class="tab active" data-tab="overview">Visão geral</button>
      <button class="tab" data-tab="scheme">Esquema</button>
      <button class="tab" data-tab="sim">Simulador</button>
      <button class="tab" data-tab="compare">Comparação</button>
      <button class="tab" data-tab="shop">Compras</button>
      <button class="tab" data-tab="gloss">Glossário</button>
    </div>
  </header>

  <main class="container">
    <!-- Overview -->
    <section data-page="overview">
      <div class="grid cols-3">
        <div class="card"><div class="body">
          <h3 class="title">Entradas fixas do apartamento</h3>
          <div>⚡️ <strong>Tensões:</strong> 127/220 V. <strong>Somente</strong> chuveiro e ares‑condicionados usam <strong>220 V bifásico</strong> (2 fases + terra). Todo o restante do pente permanece <strong>127 V</strong>.</div>
          <div class="kv"><span class="muted">Proteção</span><span>DR 4P‑63 A‑30 mA</span></div>
          <div class="kv"><span class="muted">Quadro</span><span>Lacrado (deslacrar + relacrar)</span></div>
          <div class="kv"><span class="muted">Agora</span><span>3 × AC 9.000 BTU (sala/quarto/escritório)</span></div>
          <div class="kv"><span class="muted">Chuveiro</span><span>até 5.400 W / 220 V</span></div>
          <div class="kv"><span class="muted">Futuro</span><span>Sala pode virar 12.000 BTU</span></div>
          <div class="kv"><span class="muted">Cabos AR (fixo)</span><span>35 m — 2,5 mm²</span></div>
          <div class="kv"><span class="muted">Cabo Chuveiro (fixo)</span><span>15 m — 4 mm²</span></div>
          <div class="sep"></div>
          <div class="muted" style="font-size:12px">Regra da planta: números sem unidade = metros (ex.: “60×57×160” = 0,6 × 0,57 × 1,6 m).</div>
        </div></div>
        <div class="card"><div class="body">
          <h3 class="title">Esqueminha</h3>
          <pre style="white-space:pre-wrap;margin:0;background:#0b1020;color:#e2e8f0;padding:12px;border-radius:12px;font-size:12px">Alimentação → DR 4P‑63 A‑30 mA → Quadro →
├─ DJ 2P 32 A → 3 fios (F1, F2, T) → Chuveiro 220 V
├─ DJ 2P 16 A → 3 fios (F1, F2, T) → AC Quarto 220 V
├─ DJ 2P 16 A → 3 fios (F1, F2, T) → AC Escritório 220 V
└─ DJ 2P 16 A ou 20 A → 3 fios (F1, F2, T) → AC Sala 220 V</pre>
          <div class="muted" style="font-size:12px;margin-top:6px">Somente esses 4 circuitos são 220 V. Restante do pente permanece 127 V.</div>
        </div></div>
        <div class="card"><div class="body">
          <h3 class="title">O que comprar agora <span class="pill">resumo</span></h3>
          <ul style="margin:0 0 6px 18px;line-height:1.5">
            <li>35 m cabo 2,5 mm² (cobre 750 V) — 3 AR</li>
            <li>15 m cabo 4 mm² (cobre 750 V) — chuveiro</li>
            <li>Disjuntores 2P curva C: 2 × 16 A (quarto, escritório) + 1 × 16/20 A (sala) + 1 × 32 A (chuveiro)</li>
            <li>Acessórios: terminais 2,5/4 mm², fita, abraçadeiras, etiquetas</li>
            <li>Opcional: pente 2P (compatível com a marca/linha do quadro)</li>
          </ul>
          <div class="muted" style="font-size:12px">Metros são <b>fixos</b>: 35 m (AR) + 15 m (chuveiro).</div>
        </div></div>
      </div>
    </section>

    <!-- Scheme SVG -->
    <section data-page="scheme" hidden>
      <div class="card"><div class="body">
        <h3 class="title">Esquema ilustrado (simplificado)</h3>
        <div style="overflow:auto;border:1px solid var(--line);border-radius:14px;padding:10px">
          <svg viewBox="0 0 960 320" width="900" height="280">
            <rect x="20" y="120" width="120" height="80" rx="12" fill="#eef2ff" stroke="#312e81" stroke-width="2"/>
            <text x="80" y="165" text-anchor="middle" font-size="12" fill="#111827">Alimentação</text>

            <rect x="180" y="120" width="140" height="80" rx="12" fill="#ecfeff" stroke="#155e75" stroke-width="2"/>
            <text x="250" y="150" text-anchor="middle" font-size="12" fill="#111827">DR 4P‑63 A‑30 mA</text>
            <text x="250" y="168" text-anchor="middle" font-size="11" fill="#6b7280">Todos os 4 circuitos</text>

            <rect x="360" y="100" width="150" height="120" rx="12" fill="#f0fdf4" stroke="#14532d" stroke-width="2"/>
            <text x="435" y="140" text-anchor="middle" font-size="12" fill="#111827">Quadro</text>

            <line x1="140" y1="160" x2="180" y2="160" stroke="#374151" stroke-width="3"/>
            <line x1="320" y1="160" x2="360" y2="160" stroke="#374151" stroke-width="3"/>

            <g>
              <line x1="510" y1="160" x2="520" y2="80" stroke="#9ca3af" stroke-width="3"/>
              <rect x="540" y="60" width="360" height="40" rx="8" fill="#fff" stroke="#9ca3af" stroke-width="2"/>
              <text x="550" y="85" font-size="12" fill="#111827">DJ 2P 32 A → Chuveiro 220 V</text>
            </g>
            <g>
              <line x1="510" y1="160" x2="520" y2="140" stroke="#9ca3af" stroke-width="3"/>
              <rect x="540" y="120" width="360" height="40" rx="8" fill="#fff" stroke="#9ca3af" stroke-width="2"/>
              <text x="550" y="145" font-size="12" fill="#111827">DJ 2P 16 A → AC Quarto 220 V</text>
            </g>
            <g>
              <line x1="510" y1="160" x2="520" y2="200" stroke="#9ca3af" stroke-width="3"/>
              <rect x="540" y="180" width="360" height="40" rx="8" fill="#fff" stroke="#9ca3af" stroke-width="2"/>
              <text x="550" y="205" font-size="12" fill="#111827">DJ 2P 16 A → AC Escritório 220 V</text>
            </g>
            <g>
              <line x1="510" y1="160" x2="520" y2="260" stroke="#9ca3af" stroke-width="3"/>
              <rect x="540" y="240" width="360" height="40" rx="8" fill="#fff" stroke="#9ca3af" stroke-width="2"/>
              <text x="550" y="265" font-size="12" fill="#111827">DJ 2P 16 A ou 20 A → AC Sala 220 V</text>
            </g>
          </svg>
        </div>
        <div class="muted" style="font-size:12px;margin-top:6px">Somente esses 4 circuitos são 220 V. Restante do pente permanece 127 V.</div>
      </div></div>
    </section>

    <!-- Simulator -->
    <section data-page="sim" hidden>
      <div class="grid cols-3">
        <div class="card"><div class="body">
          <h3 class="title">AC Sala <span id="badgeSala" class="badge">9.000 BTU</span></h3>
          <div class="row"><span class="muted">Ligado</span><div class="switch" id="swSala" role="switch" aria-checked="true" tabindex="0"></div></div>
          <div class="row" style="margin-top:8px"><span class="muted">Simular 12.000 BTU (futuro)</span><div class="switch" id="swSala12k" role="switch" aria-checked="false" tabindex="0"></div></div>
          <div style="margin-top:10px">
            <div class="muted" style="font-size:12px">Corrente típica: <span id="salaRange">6–10</span> A</div>
            <input type="range" id="rngSala" min="6" max="10" step="0.1" value="8" />
            <div style="margin-top:6px"><b id="outSalaA">8.0</b> A → <b id="outSalaW">1760</b> W</div>
          </div>
        </div></div>
        <div class="card"><div class="body">
          <h3 class="title">AC Quarto</h3>
          <div class="row"><span class="muted">Ligado</span><div class="switch" id="swQuarto" role="switch" aria-checked="true" tabindex="0"></div></div>
          <div style="margin-top:10px">
            <div class="muted" style="font-size:12px">Corrente típica: 6–10 A</div>
            <input type="range" id="rngQuarto" min="6" max="10" step="0.1" value="8" />
            <div style="margin-top:6px"><b id="outQuartoA">8.0</b> A → <b id="outQuartoW">1760</b> W</div>
          </div>
        </div></div>
        <div class="card"><div class="body">
          <h3 class="title">AC Escritório</h3>
          <div class="row"><span class="muted">Ligado</span><div class="switch" id="swEscritorio" role="switch" aria-checked="true" tabindex="0"></div></div>
          <div style="margin-top:10px">
            <div class="muted" style="font-size:12px">Corrente típica: 6–10 A</div>
            <input type="range" id="rngEscritorio" min="6" max="10" step="0.1" value="8" />
            <div style="margin-top:6px"><b id="outEscritorioA">8.0</b> A → <b id="outEscritorioW">1760</b> W</div>
          </div>
        </div></div>
      </div>

      <div class="grid cols-3" style="margin-top:16px">
        <div class="card"><div class="body">
          <h3 class="title">Chuveiro</h3>
          <div class="row"><span class="muted">Ligado</span><div class="switch" id="swChuveiro" role="switch" aria-checked="false" tabindex="0"></div></div>
          <div style="margin-top:10px">5400 W (≈ <span id="chuveiroA">24.5</span> A em 220 V)</div>
        </div></div>
        <div class="card"><div class="body">
          <h3 class="title">Tempo & Tarifa</h3>
          <div class="muted" style="font-size:12px">Horas por dia</div>
          <input type="range" id="rngHoras" min="1" max="24" step="1" value="6" />
          <div><b id="outHoras">6</b> h/dia</div>
          <div class="muted" style="font-size:12px;margin-top:8px">Dias no mês</div>
          <input type="range" id="rngDias" min="1" max="31" step="1" value="30" />
          <div><b id="outDias">30</b> dias/mês</div>
          <div class="muted" style="font-size:12px;margin-top:8px">Tarifa de energia (R$/kWh)</div>
          <input type="number" id="inpTarifa" value="0.95" step="0.01" inputmode="decimal" />
        </div></div>
        <div class="card"><div class="body">
          <h3 class="title">Resultados</h3>
          <div class="kv"><span class="muted">Potência total</span><span id="outW">—</span></div>
          <div class="kv"><span class="muted">Corrente total</span><span id="outA">—</span></div>
          <div class="sep"></div>
          <div class="kv"><span class="muted">Consumo por dia</span><span id="outKWhDia">—</span></div>
          <div class="kv"><span class="muted">Custo por dia</span><span id="outR$Dia">—</span></div>
          <div class="kv"><span class="muted">Custo por mês</span><span id="outR$Mes">—</span></div>
          <div id="callout" class="callout ok" style="margin-top:8px">Valores didáticos. Evite usar chuveiro + 3 AC no máximo + forno simultaneamente.</div>
        </div></div>
      </div>

      <div class="card" style="margin-top:16px"><div class="body">
        <h3 class="title">Distribuição de potência (W)</h3>
        <div class="bars">
          <div class="bar" id="barSala" style="height:10%"><span id="labSala">0 W</span></div>
          <div class="bar" id="barQuarto" style="height:10%"><span id="labQuarto">0 W</span></div>
          <div class="bar" id="barEscritorio" style="height:10%"><span id="labEscritorio">0 W</span></div>
          <div class="bar" id="barChuveiro" style="height:10%"><span id="labChuveiro">0 W</span></div>
        </div>
        <div class="bar-labels">
          <div>Sala</div>
          <div>Quarto</div>
          <div>Escritório</div>
          <div>Chuveiro</div>
        </div>
      </div></div>
    </section>

    <!-- Compare -->
    <section data-page="compare" hidden>
      <div class="card"><div class="body">
        <h3 class="title">Pedido × Ideal agora × Futuro</h3>
        <div class="scroll-x">
          <table>
            <thead><tr><th>Item</th><th>Pedido (ref.)</th><th>Ideal AGORA (3 × 9k + 1 chuveiro)</th><th>FUTURO (sala 12k)</th></tr></thead>
            <tbody>
              <tr><td><b>Cabos AR (3 pontos / 35 m)</b></td><td>30 m 2,5 mm²</td><td>2,5 mm² (cobre 750 V), 3 fios por circuito (F1, F2, T). Distribuir os 35 m conforme a planta.</td><td>Mantém 2,5 mm² (suporta ~9–15 A típicos do 12k).</td></tr>
              <tr><td><b>Disjuntores AR</b></td><td>(eventuais) 2 × 25 A</td><td>2P 16 A p/ quarto e escritório; sala: 2P 16 A ou 2P 20 A (se 9k aceitar 20 A, usar 20 A).</td><td>Sala: 2P 20 A (se ainda não estiver). Demais iguais.</td></tr>
              <tr><td><b>Cabo Chuveiro (15 m)</b></td><td>10 mm²</td><td>4 mm² (cobre 750 V), 3 fios (F1, F2, T).</td><td>Igual.</td></tr>
              <tr><td><b>Disjuntor Chuveiro</b></td><td>1 × 32 A</td><td>2P 32 A exclusivo</td><td>Igual.</td></tr>
              <tr><td><b>Pente 2P</b></td><td>1 pente 14 DJ</td><td>Opcional (somente se compatível com a marca/linha do quadro).</td><td>Igual.</td></tr>
            </tbody>
          </table>
        </div>
      </div></div>
    </section>

    <!-- Shopping -->
    <section data-page="shop" hidden>
      <div class="grid cols-2">
        <div class="card"><div class="body">
          <h3 class="title">Cabos para os 3 AR — 35 m (2,5 mm²)</h3>
          <p><b>Pergunta:</b> vem em rolo ou já desmembrado?</p>
          <p><b>Resposta:</b> pode comprar <i>por metro</i> (35 m corridos) ou em <i>rolo</i> (25/50/100 m). O eletricista corta na instalação. Para cada AC são <b>3 fios</b> (F1, F2, Terra). <b>Cores sugeridas:</b> fases diferentes (ex.: preto/vermelho) e terra verde‑amarelo.</p>
        </div></div>
        <div class="card"><div class="body">
          <h3 class="title">Cabo do chuveiro — 15 m (4 mm²)</h3>
          <p>Compre por metro (15 m corridos). São 3 fios (F1, F2, Terra) até a caixa do chuveiro.</p>
        </div></div>
        <div class="card"><div class="body">
          <h3 class="title">Disjuntores dos AR</h3>
          <p>• 2 unidades de <b>2P × 16 A</b> (quarto e escritório). <i>Um disjuntor protege 1 circuito.</i></p>
          <p>• Sala: <b>2P × 16 A ou 2P × 20 A</b>. <i>Mais comum hoje:</i> 9.000 BTU usa 16 A; 20 A quando o fabricante pede corrente maior ou pensando no futuro 12.000 BTU.</p>
        </div></div>
        <div class="card"><div class="body">
          <h3 class="title">Disjuntor do chuveiro</h3>
          <p><b>2P × 32 A exclusivo</b> porque o chuveiro é 220 V e precisa desligar as duas fases ao mesmo tempo.</p>
        </div></div>
        <div class="card" style="grid-column:1/-1"><div class="body">
          <h3 class="title">Acessórios</h3>
          <p>Terminais 2,5/4 mm², fita isolante, abraçadeiras, etiquetas para identificar cada circuito. <b>Pente 2P</b> é opcional (apenas se compatível com a mesma marca/linha do quadro).</p>
        </div></div>
      </div>
    </section>

    <!-- Glossary -->
    <section data-page="gloss" hidden>
      <div class="grid cols-3">
        <div class="card"><div class="body"><b>Bitola (mm²)</b>: “grossura” do cobre; mais mm² = mais corrente.</div></div>
        <div class="card"><div class="body"><b>2P/bipolar</b>: disjuntor que desliga as duas fases do 220 V ao mesmo tempo.</div></div>
        <div class="card"><div class="body"><b>Curva C</b>: padrão residencial; evita desarme à toa na partida do motor (AC).</div></div>
        <div class="card"><div class="body"><b>DR</b>: proteção “antichoque”; desarma com fuga de corrente.</div></div>
        <div class="card"><div class="body"><b>Fase/Terra</b>: fases levam energia; terra é segurança.</div></div>
      </div>
    </section>

    <footer>
      Metros de cabo são <b>fixos</b>: 35 m (AR) + 15 m (chuveiro). Não recalcular. Distribuir os 35 m entre os 3 pontos conforme as rotas da planta. Deslacrar e relacrar com a construtora.
    </footer>
  </main>

  <script>
    // ===== Basics =====
    const $$ = (sel, ctx=document) => Array.from(ctx.querySelectorAll(sel));
    const $ = (sel, ctx=document) => ctx.querySelector(sel);

    // Tabs
    $$('.tab').forEach(btn=>{
      btn.addEventListener('click',()=>{
        $$('.tab').forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        const id = btn.dataset.tab;
        $$('main [data-page]').forEach(s=>s.hidden = s.dataset.page!==id);
      })
    })

    // Print & copy
    $('#printBtn').addEventListener('click',()=>window.print());
    const shoppingList = `• 35 m de cabo 2,5 mm² (cobre 750 V) para os 3 AR.\n• 15 m de cabo 4 mm² (cobre 750 V) para o chuveiro.\n• Disjuntores 2P curva C: 2 × 16 A (quarto, escritório) + 1 × 16 A ou 20 A (sala) + 1 × 32 A (chuveiro).\n• Acessórios: terminais 2,5/4 mm², fita isolante, abraçadeiras, etiquetas.\n• Opcional: pente 2P compatível com a mesma marca/linha do quadro.`;
    $('#copyBtn').addEventListener('click', async ()=>{
      try{ await navigator.clipboard.writeText(shoppingList); alert('Lista copiada!'); }catch(e){ console.error(e); }
    });

    // ===== Simulator =====
    const VOLT = 220;
    const SHOWER_W = 5400; // ≈24.5 A @ 220 V

    // switches
    function toggle(sw){ sw.classList.toggle('on'); sw.setAttribute('aria-checked', sw.classList.contains('on')); update(); }
    ['swSala','swQuarto','swEscritorio','swChuveiro','swSala12k'].forEach(id=>{
      const el = document.getElementById(id);
      el.addEventListener('click',()=>toggle(el));
      el.addEventListener('keydown',e=>{ if(e.key==='Enter'||e.key===' '){e.preventDefault(); toggle(el);} });
    });

    // ranges / inputs
    ['rngSala','rngQuarto','rngEscritorio','rngHoras','rngDias'].forEach(id=>{ $("#"+id).addEventListener('input',update); });
    $('#inpTarifa').addEventListener('input',()=>{ const v = $('#inpTarifa').value.replace(',','.'); $('#inpTarifa').value = v; update(); });

    function getA(id){ return parseFloat($(id).textContent.replace(',','.')) }

    function update(){
      const sala12k = $('#swSala12k').classList.contains('on');
      $('#badgeSala').textContent = sala12k ? '12.000 BTU' : '9.000 BTU';
      const min = sala12k ? 9 : 6, max = sala12k ? 15 : 10;
      $('#salaRange').textContent = `${min}–${max}`;
      const rngSala = $('#rngSala');
      if(parseFloat(rngSala.min)!==min){ rngSala.min=min; }
      if(parseFloat(rngSala.max)!==max){ rngSala.max=max; }
      if(parseFloat(rngSala.value) < min) rngSala.value = String(min);
      if(parseFloat(rngSala.value) > max) rngSala.value = String(max);

      const salaOn = $('#swSala').classList.contains('on');
      const quartoOn = $('#swQuarto').classList.contains('on');
      const escriOn = $('#swEscritorio').classList.contains('on');
      const chuveiroOn = $('#swChuveiro').classList.contains('on');

      const iSala = salaOn ? parseFloat($('#rngSala').value) : 0;
      const iQuarto = quartoOn ? parseFloat($('#rngQuarto').value) : 0;
      const iEscri = escriOn ? parseFloat($('#rngEscritorio').value) : 0;
      const wSala = Math.round(VOLT * iSala);
      const wQuarto = Math.round(VOLT * iQuarto);
      const wEscri = Math.round(VOLT * iEscri);
      const wChuv = chuveiroOn ? SHOWER_W : 0;

      $('#outSalaA').textContent = iSala.toFixed(1);
      $('#outSalaW').textContent = String(wSala);
      $('#outQuartoA').textContent = iQuarto.toFixed(1);
      $('#outQuartoW').textContent = String(wQuarto);
      $('#outEscritorioA').textContent = iEscri.toFixed(1);
      $('#outEscritorioW').textContent = String(wEscri);

      const totalW = wSala + wQuarto + wEscri + wChuv;
      const totalA = totalW / VOLT;
      $('#outW').textContent = `${totalW} W`;
      $('#outA').textContent = `${totalA.toFixed(1)} A @ 220 V`;

      const horas = parseInt($('#rngHoras').value,10);
      const dias = parseInt($('#rngDias').value,10);
      $('#outHoras').textContent = String(horas);
      $('#outDias').textContent = String(dias);
      const tarifa = Math.max(0, parseFloat($('#inpTarifa').value)||0);

      const kWhDia = (totalW/1000) * horas;
      const RSDia = kWhDia * tarifa;
      const RSMes = RSDia * dias;
      $('#outKWhDia').textContent = `${kWhDia.toFixed(2)} kWh`;
      $('#outR$Dia').textContent = RSDia.toLocaleString('pt-BR',{style:'currency',currency:'BRL'});
      $('#outR$Mes').textContent = RSMes.toLocaleString('pt-BR',{style:'currency',currency:'BRL'});

      // load level vs 63 A
      const call = $('#callout');
      call.classList.remove('ok','warn','danger');
      if(totalA >= 63){ call.classList.add('danger'); call.textContent = 'Corrente total ≥ 63 A. Revise simultaneidade e dimensionamento do geral.'; }
      else if(totalA >= 55){ call.classList.add('warn'); call.textContent = 'Corrente total alta. Evite chuveiro + 3 AC + forno ao mesmo tempo.'; }
      else { call.classList.add('ok'); call.textContent = 'Valores didáticos. 220 V apenas ACs e chuveiro; todos os 4 circuitos passam pelo DR.'; }

      // bars
      const maxW = Math.max(1, wSala, wQuarto, wEscri, wChuv);
      const pct = w => 10 + (w/maxW)*90; // min 10% height to stay visible
      $('#barSala').style.height = pct(wSala)+'%'; $('#labSala').textContent = wSala+' W';
      $('#barQuarto').style.height = pct(wQuarto)+'%'; $('#labQuarto').textContent = wQuarto+' W';
      $('#barEscritorio').style.height = pct(wEscri)+'%'; $('#labEscritorio').textContent = wEscri+' W';
      $('#barChuveiro').style.height = pct(wChuv)+'%'; $('#labChuveiro').textContent = wChuv+' W';
    }

    // initial state
    $('#swSala').classList.add('on');
    $('#swQuarto').classList.add('on');
    $('#swEscritorio').classList.add('on');
    update();
  </script>
</body>
</html>
